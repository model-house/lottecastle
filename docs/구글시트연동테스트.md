# 구글 시트 연동 테스트 가이드

## 1. 기본 테스트
1. 웹사이트에서 상담 신청 폼 작성
2. 제출 버튼 클릭
3. 성공 메시지 확인
4. Google Sheets에서 데이터 확인

## 2. 문제 해결

### CORS 에러가 발생하는 경우
```javascript
// formHandler.js에서 iframe 방식으로 변경
// sendToGoogleSheet 메서드에서:
// this.sendViaIframe(data); // 주석 해제
```

### 403 에러가 발생하는 경우
1. Google Apps Script 배포 설정 확인
   - 다음 사용자로 실행: 나
   - 액세스 권한: 모든 사용자

2. 새로 배포하면 URL이 변경됨
   - 배포 관리 > 활성 배포 수정

### 데이터가 저장되지 않는 경우
1. 스프레드시트 ID 확인
2. Apps Script 에러 로그 확인
   - Apps Script 편집기 > 실행 > 로그

## 3. 로컬 백업 확인
브라우저 콘솔에서:
```javascript
// 저장된 데이터 확인
const submissions = JSON.parse(localStorage.getItem('contactSubmissions'));
console.table(submissions);

// CSV로 내보내기
app.formHandler.exportToCSV();
```

## 4. 도메인 제한 설정 (선택사항)
Google Apps Script에서:
```javascript
// 특정 도메인만 허용
const allowedDomains = ['purugo.com', 'www.purugo.com'];
const origin = e.parameter.referrer || '';

if (!allowedDomains.some(domain => origin.includes(domain))) {
  throw new Error('Unauthorized domain');
}
```

## 5. 이메일 알림 설정 (선택사항)
1. Apps Script에서 sendEmailNotification 함수 활성화
2. 수신 이메일 주소 설정
3. Gmail 권한 승인

## 6. 실시간 모니터링
- Google Sheets에서 실시간 업데이트 확인
- 조건부 서식으로 새 항목 강조 표시
- 필터/정렬로 데이터 관리
